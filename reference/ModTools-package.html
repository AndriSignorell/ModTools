<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Regression and Classification Tools — ModTools-package • ModTools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression and Classification Tools — ModTools-package"><meta name="description" content="There is a rich selection of R packages implementing algorithms for classification and regression tasks out there. The authors legitimately take the liberty to tailor the function interfaces according to their own taste  and needs. For us other users, however, this often results in struggling with user interfaces, some of which are rather weird - to put it mildly - and almost always different in terms of arguments and result structures.
ModTools pursues the goal of offering uniform handling for the most important regression and classification models in applied data analyses.
The function FitMod() is designed as a simple and consistent interface to these original functions while maintaining the flexibility to pass on all possible arguments. print, plot, summary and predict operations can so be carried out following the same logic. The results will again be reshaped to a reasonable standard.
For all the functions of this package Google styleguides are used as naming rules (in absence of convincing alternatives). The 'BigCamelCase' style has been consequently applied to functions borrowed from contributed R packages as well.
As always: Feedback, feature requests, bugreports and other suggestions are welcome!"><meta property="og:description" content="There is a rich selection of R packages implementing algorithms for classification and regression tasks out there. The authors legitimately take the liberty to tailor the function interfaces according to their own taste  and needs. For us other users, however, this often results in struggling with user interfaces, some of which are rather weird - to put it mildly - and almost always different in terms of arguments and result structures.
ModTools pursues the goal of offering uniform handling for the most important regression and classification models in applied data analyses.
The function FitMod() is designed as a simple and consistent interface to these original functions while maintaining the flexibility to pass on all possible arguments. print, plot, summary and predict operations can so be carried out following the same logic. The results will again be reshaped to a reasonable standard.
For all the functions of this package Google styleguides are used as naming rules (in absence of convincing alternatives). The 'BigCamelCase' style has been consequently applied to functions borrowed from contributed R packages as well.
As always: Feedback, feature requests, bugreports and other suggestions are welcome!"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ModTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.12.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AndriSignorell/ModTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Regression and Classification Tools</h1>

      <div class="d-none name"><code>ModTools-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>There is a rich selection of R packages implementing algorithms for classification and regression tasks out there. The authors legitimately take the liberty to tailor the function interfaces according to their own taste  and needs. For us other users, however, this often results in struggling with user interfaces, some of which are rather weird - to put it mildly - and almost always different in terms of arguments and result structures.
<b>ModTools</b> pursues the goal of offering uniform handling for the most important regression and classification models in applied data analyses.<br>
The function <code><a href="FitMod.html">FitMod()</a></code> is designed as a simple and consistent interface to these original functions while maintaining the flexibility to pass on all possible arguments. <code>print</code>, <code>plot</code>, <code>summary</code> and <code>predict</code> operations can so be carried out following the same logic. The results will again be reshaped to a reasonable standard.</p>
<p>For all the functions of this package Google styleguides are used as naming rules (in absence of convincing alternatives). The 'BigCamelCase' style has been consequently applied to functions borrowed from contributed R packages as well.</p>
<p>As always: Feedback, feature requests, bugreports and other suggestions are welcome!</p>
    </div>


    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>This package is still under development. You should be aware that everything in the package might be subject to change. Backward compatibility is not yet guaranteed. Functions may be deleted or renamed and new syntax may be inconsistent with earlier versions. By release of version 1.0 the "deprecated-defunct process" will be installed.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>ModTools::<a href="FitMod.html">FitMod</a>())</code> function comprises interfaces to the following models:</p><table class="table table"><tr><td><b>Regression</b>:</td><td></td></tr><tr><td><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>()</code></td><td>Linear model OLS (<b>base</b>)</td></tr><tr><td><code><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html" class="external-link">lmrob</a>()</code></td><td>Robust linear model (<b>robustbase</b>)</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code></td><td>GLM model with family <code>poisson</code> (<b>base</b>)</td></tr><tr><td><code>negbin()</code></td><td>GLM model with family <code>negative.binomial</code> (<b>MASS</b>)</td></tr><tr><td><code><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma()</a></code></td><td>GLM model with family <code>gamma</code> (<b>base</b>)</td></tr><tr><td><code>tobit()</code></td><td>Tobit model for censored responses (package  <b>AER</b>)</td></tr><tr><td></td><td></td></tr><tr><td></td><td><b>Classification</b>:</td></tr><tr><td></td><td><code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">lda</a>()</code></td></tr><tr><td>Linear discriminant analysis (<b>MASS</b>)</td><td><code><a href="https://rdrr.io/pkg/MASS/man/qda.html" class="external-link">qda</a>()</code></td></tr><tr><td>Quadratic discriminant analysis (<b>MASS</b>)</td><td><code>logit()</code></td></tr><tr><td>Logistic Regression model <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, family <code>binomial(logit)</code>(<b>base</b>)</td><td><code><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">multinom</a>()</code></td></tr><tr><td>Multinomial Regression model (<b>nnet</b>)</td><td><code><a href="https://rdrr.io/pkg/MASS/man/polr.html" class="external-link">polr</a>()</code></td></tr><tr><td>Proportional odds model (<b>MASS</b>)</td><td><code><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a>()</code></td></tr><tr><td>Regression and classification trees (<b>rpart</b>)</td><td><code><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a>()</code></td></tr><tr><td>Neuronal networks (<b>nnet</b>)</td><td><code><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a>()</code></td></tr><tr><td>Random forests (<b>randomForest</b>)</td><td><code><a href="https://topepo.github.io/C5.0/reference/C5.0.html" class="external-link">C5.0</a>()</code></td></tr><tr><td>C5.0 tree (<b>C50</b>)</td><td><code><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a>()</code></td></tr><tr><td>Support vector machines (<b>e1071</b>)</td><td><code><a href="https://majkamichal.github.io/naivebayes/reference/naive_bayes.html" class="external-link">naive_bayes</a>()</code></td></tr><tr><td>Naive Bayes classificator (<b>naivebayes</b>)</td><td><code><a href="LogitBoost.html">LogitBoost</a>()</code></td></tr><tr><td>Logit boost (using decision
  stumps as weak learners) (<b>ModTools</b>)</td><td><!-- % maybe later down the road -->
<!-- %   \cr\cr\cr \bold{Other interfaced functions}:\tab\cr -->
<!-- %   \code{\link[class]{knn}()}  \tab 	 k nearest neighbours (package  \bold{class})\cr -->
<!-- %   \code{\link[class]{SOM}()}  \tab 	 Self organizing maps (package  \bold{class})\cr -->

<!-- % \link{BestTree}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{PlotHistLeaf}  \tab 	 Tuning for many models\cr -->
<!-- % \link{PlotTree}  \tab 	 Confusion matrix for classification tasks\cr -->
<!-- % \link{LeafRates}  \tab 	 Confusion matrix for classification tasks\cr -->
<!-- % \link{Purity}  \tab 	 Confusion matrix for classification tasks\cr -->
<!-- % \link{Snip}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{Flop}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{Improve}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{Desc.rpart}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{Splits}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{Rules}  \tab 	 Variable importance for many models\cr -->
<!-- % \link{TreeDepth}  \tab 	 Variable importance for many models\cr --></td></tr><tr><td></td><td></td></tr><tr><td><b>Preprocess</b>:</td><td></td></tr><tr><td><code><a href="SplitTrainTest.html">SplitTrainTest</a>()</code></td><td>Splits a data frame or index vector into a training and a test sample</td></tr><tr><td><code><a href="OverSample.html">OverSample</a>()</code></td><td>Get balanced datasets by sampling with replacement.</td></tr><tr><td></td><td></td></tr><tr><td></td><td><b>Manipulating <code>rpart</code> objects</b>:</td></tr><tr><td></td><td><code><a href="CP.html">CP</a>()</code></td></tr><tr><td>Extract and plot complexity table of an rpart tree.</td><td><code><a href="Node.html">Node</a>()</code></td></tr><tr><td>Accessor to the most important properties of a node, being a split or a leaf.</td><td><code><a href="Rules.html">Rules</a>()</code></td></tr><tr><td>Extract the decision rules from top to the end node of an rpart tree.</td><td><code><a href="LeafRates.html">LeafRates</a>()</code></td></tr><tr><td>Returns the misclassification rates in all end nodes.</td><td></td></tr><tr><td></td><td></td></tr><tr><td><b>Prediction and Validation</b>:</td><td></td></tr><tr><td><code><a href="Response.html">Response</a>()</code></td><td>Extract the response variable of any model.</td></tr><tr><td><code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a>()</code></td><td>Consistent predict for <code>FitMod</code> models</td></tr><tr><td><code><a href="VarImp.html">VarImp</a>()</code></td><td>Variable importance for most <code>FitMod</code> models</td></tr><tr><td><code><a href="ROC.html">ROC</a>()</code></td><td>ROC curves for all dichotomous classification <code>FitMod</code> models</td></tr><tr><td><code><a href="BestCut.html">BestCut</a>()</code></td><td>Find the optimal cut for a classification based on the ROC curve.</td></tr><tr><td><code><a href="PlotLift.html">PlotLift</a>()</code></td><td>Produces a lift chart for a binary classification model</td></tr><tr><td><code><a href="TModC.html">TModC</a>()</code></td><td>Aggregated results for multiple <code>FitMod</code> classification models</td></tr><tr><td><code><a href="Tune.html">Tune</a>()</code></td><td>Tuning approaches to find optimal parameters for <code>FitMod</code> classification models.</td></tr><tr><td><code><a href="RobSummary.html">RobSummary</a>()</code></td><td>Robust summary for GLM models (poisson).</td></tr><tr><td><!-- %\code{\link{CV}}  \tab Crossvalidating approaches for \code{FitMod} models	 \cr --></td><td></td></tr><tr><td></td><td><b>Tests</b>:</td></tr><tr><td></td><td><code><a href="BreuschPaganTest.html">BreuschPaganTest</a>()</code></td></tr><tr><td>Breusch-Pagan test against heteroskedasticity.</td><td><!-- %\code{\link{CoefTest}}  \tab 	 Coefficient test\cr --></td></tr></table><p><!-- %We might want to add support later down the road for: -->
<!-- %mixed models, gam, mars, lasso\cr -->
<!-- %ART Adaptive Resonance Theory cluster, association rules, multidimensional scaling -->
<!-- % -->
<!-- %preprocess: -->
<!-- %1. Check for near zero variance predictors and flag as near zero if: -->
<!-- %* the percentage of unique values is less than 20 -->
<!-- %* the ratio of the most frequent to the second most frequent value is greater than 20, -->
<!-- % -->
<!-- %transformations, retransformation: rcs - restricted cubic splines smearingEstimator --></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Andri Signorell<br>
Helsana Versicherungen AG, Health Sciences, Zurich<br>
HWZ University of Applied Sciences in Business Administration Zurich.<br></p>
<p>Includes R source code and/or documentation previously published by (in alphabetical order): <br>
Bernhard Compton, Marcel Dettling, Max Kuhn, Michal Majka, Dan Putler, Jarek Tuszynski, Robin Xavier, Achim Zeileis</p>
<p>The good things come from all these guys, any problems are likely due to my tweaking.
Thank you all! <br></p>
<p>Maintainer: Andri Signorell &lt;andri@signorell.net&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.swiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Fertility</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">swiss</span>, fitfn<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.swiss</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = Fertility ~ ., data = swiss)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      (Intercept)       Agriculture       Examination         Education  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          66.9152           -0.1721           -0.2580           -0.8709  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Catholic  Infant.Mortality  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           0.1041            1.0770  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># PlotTA(r.swiss)</span></span></span>
<span class="r-in"><span><span class="co"># PlotQQNorm(r.swiss)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Count models</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">housing</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># poisson count</span></span></span>
<span class="r-in"><span><span class="va">r.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, family<span class="op">=</span><span class="va">poisson</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># negative binomial count</span></span></span>
<span class="r-in"><span><span class="va">r.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"negbin"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r.nb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm.nb(formula = Freq ~ Infl * Type * Cont + Sat, data = housing, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     init.theta = 11.58904011, link = log)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                        3.14037    0.20801  15.097  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium                         0.26615    0.28836   0.923 0.356028    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh                          -0.25336    0.30111  -0.841 0.400113    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment                      0.39532    0.28603   1.382 0.166945    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium                        -0.77634    0.32149  -2.415 0.015742 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace                       -0.80653    0.32296  -2.497 0.012515 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ContHigh                          -0.02395    0.29474  -0.081 0.935244    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.L                              0.16860    0.07525   2.240 0.025070 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.Q                              0.25749    0.07821   3.292 0.000994 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment          -0.12807    0.39875  -0.321 0.748082    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment             0.15140    0.41087   0.368 0.712507    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium             -0.41265    0.45633  -0.904 0.365849    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium               -0.13006    0.47471  -0.274 0.784108    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace             0.01666    0.44423   0.038 0.970080    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace              -0.06969    0.47429  -0.147 0.883177    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:ContHigh               -0.12632    0.41042  -0.308 0.758256    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:ContHigh                 -0.59072    0.44424  -1.330 0.183609    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment:ContHigh             0.52179    0.40019   1.304 0.192281    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium:ContHigh                0.71556    0.43760   1.635 0.102013    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace:ContHigh               1.15028    0.43270   2.658 0.007852 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment:ContHigh  0.01178    0.56001   0.021 0.983224    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment:ContHigh    0.13235    0.59111   0.224 0.822837    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium:ContHigh     0.14135    0.62032   0.228 0.819752    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium:ContHigh       0.42364    0.65770   0.644 0.519496    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace:ContHigh   -0.51739    0.60483  -0.855 0.392307    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace:ContHigh     -0.49705    0.66522  -0.747 0.454946    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for Negative Binomial(11.589) family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 275.558  on 71  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:  67.887  on 46  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 535.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Theta:  11.59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Std. Err.:  2.92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2 x log-likelihood:  -481.289 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.log</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">)</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r.log</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = log(Freq) ~ Infl * Type * Cont + Sat, data = housing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.90539 -0.22284  0.01119  0.18857  0.96514 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                        3.140416   0.267518  11.739 1.95e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium                         0.259891   0.378328   0.687   0.4956    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh                          -0.379083   0.378328  -1.002   0.3216    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment                      0.219444   0.378328   0.580   0.5647    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium                        -0.785497   0.378328  -2.076   0.0435 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace                       -0.931069   0.378328  -2.461   0.0177 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ContHigh                          -0.075612   0.378328  -0.200   0.8425    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.L                              0.199559   0.094582   2.110   0.0403 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.Q                              0.199376   0.094582   2.108   0.0405 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment           0.048725   0.535036   0.091   0.9278    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment             0.398374   0.535036   0.745   0.4603    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium             -0.400214   0.535036  -0.748   0.4583    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium                0.002462   0.535036   0.005   0.9963    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace             0.143412   0.535036   0.268   0.7899    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace               0.154151   0.535036   0.288   0.7746    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:ContHigh               -0.105500   0.535036  -0.197   0.8446    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:ContHigh                 -0.737873   0.535036  -1.379   0.1745    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment:ContHigh             0.697935   0.535036   1.304   0.1986    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium:ContHigh                0.763012   0.535036   1.426   0.1606    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace:ContHigh               1.114096   0.535036   2.082   0.0429 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment:ContHigh -0.141229   0.756655  -0.187   0.8528    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment:ContHigh    0.087753   0.756655   0.116   0.9082    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium:ContHigh     0.060731   0.756655   0.080   0.9364    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium:ContHigh       0.503181   0.756655   0.665   0.5094    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace:ContHigh   -0.531148   0.756655  -0.702   0.4862    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace:ContHigh     -0.296310   0.756655  -0.392   0.6972    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.4634 on 46 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.751,	Adjusted R-squared:  0.6157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 5.551 on 25 and 46 DF,  p-value: 2.796e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r.ols</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = Freq ~ Infl * Type * Cont + Sat, data = housing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -22.4861  -5.2361  -0.1944   3.5347  27.0556 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                        2.333e+01  7.076e+00   3.298  0.00189 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium                         7.333e+00  1.001e+01   0.733  0.46737   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh                          -4.333e+00  1.001e+01  -0.433  0.66700   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment                      1.033e+01  1.001e+01   1.033  0.30717   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium                        -1.267e+01  1.001e+01  -1.266  0.21195   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace                       -1.300e+01  1.001e+01  -1.299  0.20037   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ContHigh                          -1.680e-14  1.001e+01   0.000  1.00000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.L                              2.976e+00  2.502e+00   1.190  0.24034   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.Q                              5.835e+00  2.502e+00   2.332  0.02412 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment          -1.667e+00  1.415e+01  -0.118  0.90676   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment             3.333e+00  1.415e+01   0.236  0.81483   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium             -8.667e+00  1.415e+01  -0.612  0.54328   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium                1.000e+00  1.415e+01   0.071  0.94397   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace            -4.000e+00  1.415e+01  -0.283  0.77871   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace               1.667e+00  1.415e+01   0.118  0.90676   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:ContHigh               -4.000e+00  1.415e+01  -0.283  0.77871   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:ContHigh                 -8.667e+00  1.415e+01  -0.612  0.54328   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment:ContHigh             2.200e+01  1.415e+01   1.555  0.12689   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium:ContHigh                1.033e+01  1.415e+01   0.730  0.46897   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace:ContHigh               2.067e+01  1.415e+01   1.460  0.15098   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment:ContHigh  2.333e+00  2.001e+01   0.117  0.90769   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment:ContHigh   -1.200e+01  2.001e+01  -0.600  0.55171   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium:ContHigh     3.000e+00  2.001e+01   0.150  0.88150   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium:ContHigh       3.667e+00  2.001e+01   0.183  0.85544   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace:ContHigh   -8.667e+00  2.001e+01  -0.433  0.66700   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace:ContHigh     -1.167e+01  2.001e+01  -0.583  0.56278   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 12.26 on 46 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.6882,	Adjusted R-squared:  0.5187 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 4.061 on 25 and 46 DF,  p-value: 1.939e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r.gam</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Infl * Type * Cont + Sat, family = "Gamma", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = housing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                        4.355e-02  1.143e-02   3.809 0.000412 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium                        -1.005e-02  1.433e-02  -0.702 0.486503    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh                           9.653e-03  1.811e-02   0.533 0.596679    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment                     -1.288e-02  1.386e-02  -0.929 0.357851    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium                         5.053e-02  2.761e-02   1.830 0.073681 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace                        5.354e-02  2.835e-02   1.889 0.065241 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ContHigh                          -1.378e-17  1.615e-02   0.000 1.000000    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.L                             -3.211e-03  3.155e-03  -1.018 0.314213    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.Q                             -9.144e-03  4.197e-03  -2.179 0.034492 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment           5.915e-03  1.766e-02   0.335 0.739147    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment            -8.770e-03  2.134e-02  -0.411 0.683073    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium              2.340e-02  4.077e-02   0.574 0.568768    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium                3.286e-02  4.794e-02   0.685 0.496500    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace            -1.346e-02  3.553e-02  -0.379 0.706642    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace               2.393e-02  4.718e-02   0.507 0.614453    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:ContHigh                4.784e-03  2.086e-02   0.229 0.819606    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:ContHigh                  4.389e-02  3.364e-02   1.305 0.198497    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment:ContHigh            -1.121e-02  1.856e-02  -0.604 0.548836    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium:ContHigh               -4.583e-02  3.247e-02  -1.412 0.164758    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace:ContHigh              -6.393e-02  3.174e-02  -2.014 0.049831 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment:ContHigh -1.765e-03  2.412e-02  -0.073 0.941979    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment:ContHigh   -3.385e-02  3.662e-02  -0.924 0.360209    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium:ContHigh    -1.225e-02  4.752e-02  -0.258 0.797727    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium:ContHigh      -5.532e-02  6.091e-02  -0.908 0.368570    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace:ContHigh    3.236e-02  4.143e-02   0.781 0.438774    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace:ContHigh      1.462e-02  6.501e-02   0.225 0.823077    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for Gamma family taken to be 0.2163103)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 38.140  on 71  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 10.671  on 46  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 538.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.gami</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"gamma"</span>, link<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r.gami</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Infl * Type * Cont + Sat, family = function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gamma(link = identity), data = housing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                        23.3635     5.7553   4.060 0.000189 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium                          7.1563     9.5281   0.751 0.456438    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh                           -7.2034     6.9307  -1.039 0.304079    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment                      12.6892    10.6939   1.187 0.241486    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium                        -11.1942     6.3987  -1.749 0.086883 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace                       -10.9532     6.4273  -1.704 0.095097 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ContHigh                           -1.6216     7.8406  -0.207 0.837058    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.L                               4.9368     1.4858   3.323 0.001755 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sat.Q                               3.2415     1.1421   2.838 0.006731 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment           -3.4540    16.4721  -0.210 0.834835    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment              1.4504    13.6446   0.106 0.915810    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium              -9.2801    10.1778  -0.912 0.366629    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium                 3.5471     7.6884   0.461 0.646714    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace             -4.5638    10.5680  -0.432 0.667870    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace                2.9450     7.6893   0.383 0.703488    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:ContHigh                -3.5733    12.5840  -0.284 0.777715    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:ContHigh                  -7.1152     8.8705  -0.802 0.426610    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeApartment:ContHigh             22.5209    18.6701   1.206 0.233888    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeAtrium:ContHigh                11.5520     9.9375   1.162 0.251043    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TypeTerrace:ContHigh               22.9328    11.8581   1.934 0.059288 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeApartment:ContHigh   0.9018    27.5339   0.033 0.974015    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeApartment:ContHigh   -13.2180    21.9476  -0.602 0.549965    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeAtrium:ContHigh      2.3032    14.8708   0.155 0.877591    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeAtrium:ContHigh        0.3769    11.2392   0.034 0.973392    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflMedium:TypeTerrace:ContHigh    -8.8401    16.8767  -0.524 0.602931    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> InflHigh:TypeTerrace:ContHigh     -14.3587    12.7806  -1.123 0.267063    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for Gamma family taken to be 0.1923107)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 38.1400  on 71  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:  9.0822  on 46  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 526.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">old</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/TMod.html" class="external-link">TMod</a></span><span class="op">(</span><span class="va">r.pois</span>, <span class="va">r.nb</span>, <span class="va">r.log</span>, <span class="va">r.ols</span>, <span class="va">r.gam</span>, <span class="va">r.gami</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 coef   r.pois         r.nb       r.log    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                        (Intercept)    3.136 ***    3.140 ***   3.140 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                         InflMedium    0.273 .      0.266       0.260    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                           InflHigh   -0.205       -0.253      -0.379    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                      TypeApartment    0.367 *      0.395       0.219    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                         TypeAtrium   -0.783 ***   -0.776 *    -0.785 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                        TypeTerrace   -0.815 ***   -0.807 *    -0.931 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                           ContHigh    1.409e-15   -0.024      -0.076    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                              Sat.L    0.116 **     0.169 *     0.200 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9                              Sat.Q    0.263 ***    0.257 ***   0.199 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          InflMedium:TypeApartment   -0.118       -0.128       0.049    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11            InflHigh:TypeApartment    0.175        0.151       0.398    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12             InflMedium:TypeAtrium   -0.407       -0.413      -0.400    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13               InflHigh:TypeAtrium   -0.169       -0.130       0.002    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14            InflMedium:TypeTerrace    0.006        0.017       0.143    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15              InflHigh:TypeTerrace   -0.093       -0.070       0.154    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16               InflMedium:ContHigh   -0.140       -0.126      -0.105    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17                 InflHigh:ContHigh   -0.609 *     -0.591      -0.738    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18            TypeApartment:ContHigh    0.503 *      0.522       0.698    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19               TypeAtrium:ContHigh    0.677 *      0.716       0.763    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20              TypeTerrace:ContHigh    1.099 ***    1.150 **    1.114 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 InflMedium:TypeApartment:ContHigh    0.054        0.012      -0.141    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   InflHigh:TypeApartment:ContHigh    0.146        0.132       0.088    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    InflMedium:TypeAtrium:ContHigh    0.156        0.141       0.061    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      InflHigh:TypeAtrium:ContHigh    0.478        0.424       0.503    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   InflMedium:TypeTerrace:ContHigh   -0.498       -0.517      -0.531    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     InflHigh:TypeTerrace:ContHigh   -0.447       -0.497      -0.296    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                               ---                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28                         r.squared    -            -           0.751    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29                     adj.r.squared    -            -           0.616    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30                             sigma    -            -           0.463    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31                            logLik -279.213     -240.645     -30.648    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32                           logLik0 -587.313     -290.899       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33                                G2  616.201      100.508       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                          deviance    -            -           9.876    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35                               AIC  610.426      535.289     115.296    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36                               BIC  669.619      596.759     176.766    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37                             numdf   26           27          25        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38                             dendf    -            -          46        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39                                 N   72           72          72        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40                            n vars    8            8           8        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41                            n coef   26           26          26        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42                                 F    -            -           5.551    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43                                 p    -            -           0.000    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44                               MAE    6.641        6.608       0.276    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45                              MAPE    0.354        0.345       0.104    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46                               MSE   92.754       97.134       0.137    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47                              RMSE    9.631        9.856       0.370    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48                          McFadden    0.525        0.173       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49                       McFaddenAdj    0.480        0.083       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50                        Nagelkerke    1.000        0.753       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51                          CoxSnell    1.000        0.752       -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r.ols        r.gam       r.gami    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    23.333 **     0.044 ***   23.363 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     7.333       -0.010        7.156    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    -4.333        0.010       -7.203    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    10.333       -0.013       12.689    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   -12.667        0.051 .    -11.194 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -13.000        0.054 .    -10.953 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    -1.680e-14   -0.000       -1.622    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     2.976       -0.003        4.937 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     5.835 *     -0.009 *      3.241 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   -1.667        0.006       -3.454    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    3.333       -0.009        1.450    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   -8.667        0.023       -9.280    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    1.000        0.033        3.547    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   -4.000       -0.013       -4.564    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    1.667        0.024        2.945    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   -4.000        0.005       -3.573    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   -8.667        0.044       -7.115    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   22.000       -0.011       22.521    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   10.333       -0.046       11.552    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20.667       -0.064 *     22.933 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    2.333       -0.002        0.902    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  -12.000       -0.034      -13.218    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    3.000       -0.012        2.303    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    3.667       -0.055        0.377    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   -8.667        0.032       -8.840    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  -11.667        0.015      -14.359    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    0.688        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    0.519        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   12.256        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 -266.465     -242.088     -236.152    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    -         -290.204     -290.204    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    -           96.232      108.104    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 6909.139        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  586.930      538.176      526.304    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  648.400      599.646      587.774    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37   25           27           27        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   46            -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   72           72           72        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    8            8            8        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   26           26           26        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    4.061        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    0.000        -            -        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    7.050        6.883        6.823    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    0.385        0.371        0.321    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   95.960       98.993      102.471    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    9.796        9.950       10.123    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    -            0.166        0.186    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    -            0.076        0.097    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    -            0.737        0.777    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    -            0.737        0.777    </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Ordered Regression</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.polr</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">Sat</span> <span class="op">~</span> <span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span>, data<span class="op">=</span><span class="va">housing</span>, fitfn<span class="op">=</span><span class="st">"polr"</span>, weights <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multinomial Regression</span></span></span>
<span class="r-in"><span><span class="co"># r.mult &lt;- FitMod(factor(Sat, ordered=FALSE) ~ Infl + Type + Cont, data=housing,</span></span></span>
<span class="r-in"><span><span class="co">#                  weights = housing$Freq, fitfn="multinom")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Regression tree</span></span></span>
<span class="r-in"><span><span class="va">r.rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Sat</span>, ordered<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">~</span> <span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span>, data<span class="op">=</span><span class="va">housing</span>,</span></span>
<span class="r-in"><span>                 weights <span class="op">=</span> <span class="va">housing</span><span class="op">$</span><span class="va">Freq</span>, fitfn<span class="op">=</span><span class="st">"rpart"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare predictions</span></span></span>
<span class="r-in"><span><span class="va">d.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Infl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">Infl</span><span class="op">)</span>, Type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">Type</span><span class="op">)</span>, Cont<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">Cont</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d.p</span><span class="op">$</span><span class="va">polr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">r.polr</span>, newdata<span class="op">=</span><span class="va">d.p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ??</span></span></span>
<span class="r-in"><span><span class="co"># d.p$ols &lt;- factor(round(predict(r.ols, newdata=d.p)^2), labels=levels(housing$Sat))</span></span></span>
<span class="r-in"><span><span class="co"># d.p$mult &lt;- predict(r.mult, newdata=d.p)</span></span></span>
<span class="r-in"><span><span class="va">d.p</span><span class="op">$</span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">r.rp</span>, newdata<span class="op">=</span><span class="va">d.p</span>, type<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d.p</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Infl      Type Cont polr   rp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Low     Tower  Low  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Medium     Tower  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    High     Tower  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Low Apartment  Low  Low  Low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Medium Apartment  Low  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    High Apartment  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Low    Atrium  Low  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Medium    Atrium  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    High    Atrium  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Low   Terrace  Low  Low  Low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Medium   Terrace  Low  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   High   Terrace  Low High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Low     Tower High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Medium     Tower High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   High     Tower High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Low Apartment High  Low  Low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Medium Apartment High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   High Apartment High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Low    Atrium High  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Medium    Atrium High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   High    Atrium High High High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    Low   Terrace High  Low  Low</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 Medium   Terrace High  Low High</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   High   Terrace High High High</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Classification with 2 classes  ***************</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.pima</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">d.pima</span>, fitfn<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.pima</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  glm(formula = diabetes ~ ., family = "binomial", data = d.pima)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     pregnant      glucose     pressure      triceps      insulin  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -8.404696     0.123182     0.035164    -0.013296     0.000619    -0.001192  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        mass     pedigree          age  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.089701     0.945180     0.014869  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 767 Total (i.e. Null);  759 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    993.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 723.4 	AIC: 741.4</span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Conf.html" class="external-link">Conf</a></span><span class="op">(</span><span class="va">r.pima</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confusion Matrix and Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction pos neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        pos 156  55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        neg 112 445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Total n : 768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Accuracy : 0.7826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  95% CI : (0.7520, 0.8103)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No Information Rate : 0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P-Value [Acc &gt; NIR] : 1.37e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Kappa : 0.4966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mcnemar's Test P-Value : 1.47e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Sensitivity : 0.5821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Specificity : 0.8900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Pos Pred Value : 0.7393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Neg Pred Value : 0.7989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Prevalence : 0.3490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Detection Rate : 0.2747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Detection Prevalence : 0.2031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Balanced Accuracy : 0.7360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F-val Accuracy : 0.6514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Matthews Cor.-Coef : 0.5041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        'Positive' Class : pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="ROC.html">ROC</a></span><span class="op">(</span><span class="va">r.pima</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/OddsRatio.html" class="external-link">OddsRatio</a></span><span class="op">(</span><span class="va">r.pima</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = diabetes ~ ., family = "binomial", data = d.pima)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Odds Ratios:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                or or.lci or.uci  Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.000  0.000  0.001 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant    1.131  1.062  1.204  1.23e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose     1.036  1.028  1.043 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure    0.987  0.977  0.997    0.0111 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps     1.001  0.987  1.014    0.9285    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin     0.999  0.997  1.001    0.1861    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass        1.094  1.062  1.127  2.76e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree    2.573  1.432  4.625    0.0016 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age         1.015  0.997  1.034    0.1112    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brier Score: 0.153     Nagelkerke R2: 0.408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rpart tree</span></span></span>
<span class="r-in"><span><span class="va">rp.pima</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">d.pima</span>, fitfn<span class="op">=</span><span class="st">"rpart"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rp.pima</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 768 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node), split, n, loss, yval, (yprob)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       * denotes terminal node</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1) root 768 268 neg (0.65104167 0.34895833)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2) glucose&lt; 127.5 485  94 neg (0.80618557 0.19381443)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       4) age&lt; 28.5 271  23 neg (0.91512915 0.08487085) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5) age&gt;=28.5 214  71 neg (0.66822430 0.33177570)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        10) mass&lt; 26.35 41   2 neg (0.95121951 0.04878049) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        11) mass&gt;=26.35 173  69 neg (0.60115607 0.39884393)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          22) glucose&lt; 99.5 55  10 neg (0.81818182 0.18181818) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          23) glucose&gt;=99.5 118  59 neg (0.50000000 0.50000000)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            46) pedigree&lt; 0.561 84  34 neg (0.59523810 0.40476190)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              92) pedigree&lt; 0.2 21   4 neg (0.80952381 0.19047619) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              93) pedigree&gt;=0.2 63  30 neg (0.52380952 0.47619048)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               186) pregnant&gt;=1.5 52  21 neg (0.59615385 0.40384615)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 372) pressure&gt;=67 40  12 neg (0.70000000 0.30000000) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 373) pressure&lt; 67 12   3 pos (0.25000000 0.75000000) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               187) pregnant&lt; 1.5 11   2 pos (0.18181818 0.81818182) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            47) pedigree&gt;=0.561 34   9 pos (0.26470588 0.73529412) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3) glucose&gt;=127.5 283 109 pos (0.38515901 0.61484099)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       6) mass&lt; 29.95 76  24 neg (0.68421053 0.31578947)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        12) glucose&lt; 145.5 41   6 neg (0.85365854 0.14634146) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        13) glucose&gt;=145.5 35  17 pos (0.48571429 0.51428571)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          26) insulin&lt; 14.5 21   8 neg (0.61904762 0.38095238) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          27) insulin&gt;=14.5 14   4 pos (0.28571429 0.71428571) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       7) mass&gt;=29.95 207  57 pos (0.27536232 0.72463768)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        14) glucose&lt; 157.5 115  45 pos (0.39130435 0.60869565)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          28) age&lt; 30.5 50  23 neg (0.54000000 0.46000000)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            56) pressure&gt;=61 40  13 neg (0.67500000 0.32500000)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             112) mass&lt; 41.8 31   7 neg (0.77419355 0.22580645) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             113) mass&gt;=41.8 9   3 pos (0.33333333 0.66666667) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            57) pressure&lt; 61 10   0 pos (0.00000000 1.00000000) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          29) age&gt;=30.5 65  18 pos (0.27692308 0.72307692) *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        15) glucose&gt;=157.5 92  12 pos (0.13043478 0.86956522) *</span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Conf.html" class="external-link">Conf</a></span><span class="op">(</span><span class="va">rp.pima</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confusion Matrix and Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction neg pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        neg 449  72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        pos  51 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Total n : 768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Accuracy : 0.8398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  95% CI : (0.8122, 0.8641)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No Information Rate : 0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P-Value [Acc &gt; NIR] : &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Kappa : 0.6410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mcnemar's Test P-Value : 0.0713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Sensitivity : 0.8980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Specificity : 0.7313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Pos Pred Value : 0.8618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Neg Pred Value : 0.7935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Prevalence : 0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Detection Rate : 0.6784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Detection Prevalence : 0.5846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Balanced Accuracy : 0.8147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F-val Accuracy : 0.8795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Matthews Cor.-Coef : 0.6422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        'Positive' Class : neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="ROC.html">ROC</a></span><span class="op">(</span><span class="va">rp.pima</span><span class="op">)</span>, col<span class="op">=</span><span class="va">hblue</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-plt img"><img src="ModTools-package-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># to be improved</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rp.pima</span>, col<span class="op">=</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/SetAlpha.html" class="external-link">SetAlpha</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span>, <span class="fl">0.4</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Random Forest</span></span></span>
<span class="r-in"><span><span class="va">rf.pima</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">d.pima</span>, method<span class="op">=</span><span class="st">"class"</span>, fitfn<span class="op">=</span><span class="st">"randomForest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rf.pima</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  randomForest(formula = diabetes ~ ., data = d.pima, method = "class",      na.action = function (object, ...)      UseMethod("na.omit")) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Type of random forest: classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Number of trees: 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of variables tried at each split: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         OOB estimate of  error rate: 23.05%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confusion matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     neg pos class.error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> neg 430  70   0.1400000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pos 107 161   0.3992537</span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Conf.html" class="external-link">Conf</a></span><span class="op">(</span><span class="va">rf.pima</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confusion Matrix and Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction neg pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        neg 430 107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        pos  70 161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Total n : 768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Accuracy : 0.7695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  95% CI : (0.7384, 0.7979)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No Information Rate : 0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P-Value [Acc &gt; NIR] : 7.16e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Kappa : 0.4760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mcnemar's Test P-Value : 0.0068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Sensitivity : 0.8600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Specificity : 0.6007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Pos Pred Value : 0.8007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Neg Pred Value : 0.6970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Prevalence : 0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Detection Rate : 0.6992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Detection Prevalence : 0.5599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Balanced Accuracy : 0.7304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F-val Accuracy : 0.8293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Matthews Cor.-Coef : 0.4789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        'Positive' Class : neg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="ROC.html">ROC</a></span><span class="op">(</span><span class="va">r.pima</span><span class="op">)</span>, col<span class="op">=</span><span class="va">hred</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-plt img"><img src="ModTools-package-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># more models to compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d.pim</span> <span class="op">&lt;-</span> <span class="fu"><a href="SplitTrainTest.html">SplitTrainTest</a></span><span class="op">(</span><span class="va">d.pima</span>, p <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdiab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">pregnant</span> <span class="op">+</span> <span class="va">glucose</span> <span class="op">+</span> <span class="va">pressure</span> <span class="op">+</span> <span class="va">triceps</span></span></span>
<span class="r-in"><span>                            <span class="op">+</span> <span class="va">insulin</span> <span class="op">+</span> <span class="va">mass</span> <span class="op">+</span> <span class="va">pedigree</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"rpart"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"randomForest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"svm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.c5</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"C5.0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"nnet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"naive_bayes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"lda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.qda</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"qda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mdiab</span>, data<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"lb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>glm<span class="op">=</span><span class="va">r.glm</span>, rp<span class="op">=</span><span class="va">r.rp</span>, rf<span class="op">=</span><span class="va">r.rf</span>, svm<span class="op">=</span><span class="va">r.svm</span>, c5<span class="op">=</span><span class="va">r.c5</span></span></span>
<span class="r-in"><span>             , nn<span class="op">=</span><span class="va">r.nn</span>, nb<span class="op">=</span><span class="va">r.nb</span>, lda<span class="op">=</span><span class="va">r.lda</span>, qda<span class="op">=</span><span class="va">r.qda</span>, lb<span class="op">=</span><span class="va">r.lb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># insight in the Regression tree</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r.rp</span>, box.palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Pal.html" class="external-link">Pal</a></span><span class="op">(</span><span class="st">"Helsana"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ModTools-package-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Insample accuracy ...</span></span></span>
<span class="r-in"><span><span class="fu"><a href="TModC.html">TModC</a></span><span class="op">(</span><span class="va">mods</span>, ord<span class="op">=</span><span class="st">"auc"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(object$call$data):</span> object 'd.pim' not found</span>
<span class="r-in"><span><span class="co"># ... is substantially different from the out-of-bag:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="TModC.html">TModC</a></span><span class="op">(</span><span class="va">mods</span>, newdata<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">test</span>, reference<span class="op">=</span><span class="va">d.pim</span><span class="op">$</span><span class="va">test</span><span class="op">$</span><span class="va">diabetes</span>, ord<span class="op">=</span><span class="st">"bs"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>predict.naive_bayes(): more features in the newdata are provided as there are probability tables in the object. Calculation is performed based on features to be found in the tables.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting levels: control = neg, case = pos</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Setting direction: controls &lt; cases</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(object$call$data):</span> object 'd.pim' not found</span>
<span class="r-in"><span><span class="co"># C5 and SVM turn out to be show-offs! They overfit quite ordinary</span></span></span>
<span class="r-in"><span><span class="co"># whereas randomforest and logit keep their promises. ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="VarImp.html">VarImp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no VarImp definition found for x (class FitMod, naive_bayes)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no VarImp definition found for x (class FitMod, lda)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no VarImp definition found for x (class FitMod, qda)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no VarImp definition found for x (class FitMod, LogitBoost)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $glm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant   3.210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose    8.176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure   2.437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps    0.056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin    1.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass       5.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree   2.970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        1.687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          varimp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose  57.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass     17.811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure 13.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age      13.531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin  12.599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant  2.970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps   2.931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree  0.866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          varimp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose  68.585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass     44.600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age      38.308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree 35.697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure 25.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant 24.142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps  20.404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin  18.435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $svm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $c5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose  100.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass     100.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age       66.180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps   20.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant  18.860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree  15.610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure   7.320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin    0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> triceps   17.802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pedigree  16.997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glucose   15.842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pressure  14.737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pregnant  12.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        8.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> insulin    7.800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mass       6.095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $qda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multinomial classification problem with n classes  ***************</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d.gl</span> <span class="op">&lt;-</span> <span class="fu"><a href="SplitTrainTest.html">SplitTrainTest</a></span><span class="op">(</span><span class="va">d.glass</span>, p <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mglass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">~</span> <span class="va">RI</span> <span class="op">+</span> <span class="va">Na</span> <span class="op">+</span> <span class="va">Mg</span> <span class="op">+</span> <span class="va">Al</span> <span class="op">+</span> <span class="va">Si</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="va">Ca</span> <span class="op">+</span> <span class="va">Ba</span> <span class="op">+</span> <span class="va">Fe</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># *** raises an unclear error in CRAN-Debian tests *** ??</span></span></span>
<span class="r-in"><span><span class="co"># r.mult &lt;- FitMod(mglass, data=d.gl$train, maxit=600, fitfn="multinom")</span></span></span>
<span class="r-in"><span><span class="va">r.rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"rpart"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"randomForest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"svm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.c5</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"C5.0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"nnet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.nbay</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"naive_bayes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"lda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># r.qda &lt;- FitMod(mglass, data=d.glass, fitfn="qda")</span></span></span>
<span class="r-in"><span><span class="va">r.lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="FitMod.html">FitMod</a></span><span class="op">(</span><span class="va">mglass</span>, data<span class="op">=</span><span class="va">d.gl</span><span class="op">$</span><span class="va">train</span>, fitfn<span class="op">=</span><span class="st">"lb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rp<span class="op">=</span><span class="va">r.rp</span>, rf<span class="op">=</span><span class="va">r.rf</span>, svm<span class="op">=</span><span class="va">r.svm</span>, c5<span class="op">=</span><span class="va">r.c5</span>,</span></span>
<span class="r-in"><span>             nn<span class="op">=</span><span class="va">r.nn</span>, nbay<span class="op">=</span><span class="va">r.nbay</span>, lda<span class="op">=</span><span class="va">r.lda</span>, lb<span class="op">=</span><span class="va">r.lb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># confusion matrix and other quality measures can be calculated with Conf()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Conf.html" class="external-link">Conf</a></span><span class="op">(</span><span class="va">r.rf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confusion Matrix and Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction  1  2  3  5  6  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1 51 10  6  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2  6 52  2  3  1  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3  1  0  5  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5  0  1  0  6  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          6  0  0  0  0  6  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          7  0  1  0  1  0 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Total n : 172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Accuracy : 0.7907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  95% CI : (0.7239, 0.8448)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     No Information Rate : 0.3721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     P-Value [Acc &gt; NIR] : &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Kappa : 0.7023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mcnemar's Test P-Value : NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistics by Class:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           1      2      3      5      6      7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sensitivity          0.8793 0.8125 0.3846 0.6000 0.8571 0.8000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specificity          0.8509 0.8611 0.9937 0.9938 1.0000 0.9868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pos Pred Value       0.7500 0.7761 0.8333 0.8571 1.0000 0.8889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neg Pred Value       0.9327 0.8857 0.9518 0.9758 0.9940 0.9740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prevalence           0.3372 0.3721 0.0756 0.0581 0.0407 0.1163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Detection Rate       0.3953 0.3895 0.0349 0.0407 0.0349 0.1047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Detection Prevalence 0.2965 0.3023 0.0291 0.0349 0.0349 0.0930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Balanced Accuracy    0.8651 0.8368 0.6892 0.7969 0.9286 0.8934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-val Accuracy       0.8095 0.7939 0.5263 0.7059 0.9231 0.8421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matthews Cor.-Coef   0.7060 0.6677 0.5450 0.7033 0.9230 0.8240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we only extract the general accuracy</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Conf.html" class="external-link">Conf</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, <span class="st">"[["</span>, <span class="st">"acc"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(object$call$data):</span> object 'd.gl' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># let's compare r.mult with a model without RI as predictor</span></span></span>
<span class="r-in"><span><span class="co"># Conf(r.mult)</span></span></span>
<span class="r-in"><span><span class="co"># Conf(update(r.mult, . ~ . -RI))</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

